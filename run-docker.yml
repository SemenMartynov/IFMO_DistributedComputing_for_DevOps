---
- name: Install Docker and manage docker-compose
  hosts: all
  become: yes
  tasks:
    - name: Copy docker-compose.yml to the remote host
      copy:
        src: ./netbox/
        dest: /home/{{ ansible_user }}/netbox/
        owner: "{{ ansible_user }}"
        group: "{{ ansible_user }}"
        directory_mode: '0644'

    - name: Run docker-compose in detached mode
      command: >
        docker compose -f /home/{{ ansible_user }}/netbox/docker-compose.yml up -d
      args:
        chdir: /home/{{ ansible_user }}