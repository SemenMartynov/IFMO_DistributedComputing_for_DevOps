# Лабораторная работа по Ansible

## Описание

Данная лабораторная работа демонстрирует процесс автоматической установки и настройки веб-сервиса WordPress с использованием Ansible. В результате выполнения проекта создаётся инфраструктура, включающая базу данных MariaDB, сервер WordPress и сервер Nginx для работы сайта.

Сайт WordPress будет доступен по адресу: **http://45.8.230.65**

---

## Минимальные требования для запуска

### Операционная система
- **Debian 12 (Eng)**

### Конфигурация сервера:
- Процессор: 1 ядро, 2.2 ГГц  
- Оперативная память: 0.5 ГБ  
- Жёсткий диск: 10 ГБ (HDD, RAID)  
- Сетевая конфигурация: 1 IP-адрес  

---

## Структура проекта

Проект состоит из нескольких Ansible плейбуков, каждый из которых выполняет свою задачу:

1. **`default_settings.yml`** – Настройка операционной системы (локаль, временная зона, пакеты).
2. **`install_docker.yml`** – Установка Docker Engine и связанных инструментов.
3. **`install_wordpress.yml`** – Подготовка директорий и деплой WordPress с использованием Docker Compose.
4. **`main.yml`** – Основной плейбук, объединяющий все этапы настройки.

---

## Подготовка системы

Перед запуском Ansible убедитесь, что сервер соответствует минимальным требованиям, а на нём установлен Python. Для установки используйте команду:

```bash
sudo apt update && sudo apt install -y python3 python3-pip
```

Установите `ansible` на свою локальную машину для выполнения плейбуков:

```bash
pip install ansible
```

---

## Переменные для настройки

Для удобства и гибкости настройки инфраструктуры используются следующие переменные:

### Общие переменные:
- `time_zone` — Временная зона.
- `locale1`, `locale2` — Настройки локали.

### Переменные базы данных:
- `db_root_password` — Пароль для пользователя `root` в MariaDB.
- `db_wordpress_user` — Имя пользователя для базы данных WordPress.
- `db_wordpress_password` — Пароль для пользователя базы данных WordPress.
- `wordpress_database` — Имя базы данных для WordPress.

### Переменные томов:
- `vol_nginx_www` — Путь для данных сайта.
- `vol_nginx_conf` — Путь для конфигурации Nginx.
- `vol_db_data` — Путь для данных базы данных.

---

## Порядок выполнения

**Шаг 1**: Запустите основной плейбук `main.yml` для выполнения полной настройки:

   ```bash
   ansible-playbook playbook.yml --ask-become-pass --ask-vault-pass
   ```

**Или запустите по отдельности каждый этап**

1. **Шаг 1**: Настройка системы.

   Запустите плейбук `default_settings.yml`:

   ```bash
   ansible-playbook -i <инвентори-файл> default_settings.yml
   ```

2. **Шаг 2**: Установите Docker.

   Запустите плейбук `install_docker.yml`:

   ```bash
   ansible-playbook -i <инвентори-файл> install_docker.yml
   ```

3. **Шаг 3**: Установите и настройте WordPress.

   Запустите плейбук `install_wordpress.yml`:

   ```bash
   ansible-playbook -i <инвентори-файл> install_wordpress.yml
   ```

---

## Результат

После выполнения всех команд будет настроено следующее:
- MariaDB с базой данных для WordPress.
- Контейнер WordPress.
- Контейнер Nginx, проксирующий запросы к WordPress.

Сайт будет доступен по адресу: **http://45.8.230.65**

---

## Замечания

- Все плейбуки используют лицензирование (SPDX License) в формате GPL-2.0-later.
- При необходимости изменения конфигурации используйте соответствующие переменные.

---

## Автор

Spartak Katvitskii  
DevOps, ITMO