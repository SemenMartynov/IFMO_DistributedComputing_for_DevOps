## ๐ฆ Distributed Computing Project: Ansible + Docker + PostgreSQL + Strapi

ะัะพะตะบั ะฐะฒัะพะผะฐัะธะทะธััะตั ัะฐะทะฒััััะฒะฐะฝะธะต CMS Strapi ะธ PostgreSQL-ะบะปะฐััะตัะฐ (ะผะฐััะตั + ัะปะตะนะฒ) ั ะฟะพะผะพััั **Ansible**, **Docker** ะธ ัะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะพะณะพ ัะฟัะฐะฒะปะตะฝะธั ะบะพะฝัะธะณััะฐัะธะตะน ัะตัะตะท `.env`.

---

### ๐ ะะพะฝะธัะพัะธะฝะณ (Prometheus + Grafana)
![monitoring.png](monitoring.png)

---
### ๐ ะะฐะฒะธัะธะผะพััะธ

- Ansible 2.18+
- ะะพะปะปะตะบัะธั `community.docker`
- ะะพะปะปะตะบัะธั `community.postgresql`

---

### ๐ ะกัััะบัััะฐ

```
IFMO_DistributedComputing_for_DevOps/
โโโ group_vars/
โ   โโโ all.yml            # ะัะต ะฟะตัะตะผะตะฝะฝัะต ะฟัะพะตะบัะฐ (.env ะฒ Ansible)
โ
โโโ playbooks/
โ   โโโ docker/
โ   โ   โโโ install.yml     # ะฃััะฐะฝะพะฒะบะฐ Docker
โ   โ   โโโ remove.yml      # ะฃะดะฐะปะตะฝะธะต Docker
โ   โ
โ   โโโ hw1/
โ   โ   โโโ install.yml     # ะะฐะทะฒััััะฒะฐะฝะธะต HW1 (Strapi + PostgreSQL)
โ   โ   โโโ remove.yml      # ะัะธััะบะฐ HW1
โ   โ
โ   โโโ hw2/
โ   โ   โโโ install.yml     # ะะฐะทะฒััััะฒะฐะฝะธะต HW2 (PostgreSQL master + replica)
โ   โ   โโโ remove.yml      # ะัะธััะบะฐ HW2
โ   โ   โโโ test.yml        # ะัะพะฒะตัะบะฐ ัะตะฟะปะธะบะฐัะธะธ ะฒ HW2
โ   โโโ hw3/
โ   โ   โโโ install.yml     # ะะฐะทะฒััััะฒะฐะฝะธะต HW3 (cAdvisor + Prometheus + Grafana)
โ   โ   โโโ remove.yml      # ะัะธััะบะฐ HW3
โโโ roles/
โ   โโโ pg_cluster_master/  # ะะพะปั ะดะปั ัะฐะทะฒะตัััะฒะฐะฝะธั ะผะฐััะตั-ะฑะฐะทั
โ   โ   โโโ tasks/
โ   โ       โโโ main.yml
โ   โ
โ   โโโ pg_cluster_replica/ # ะะพะปั ะดะปั ัะฐะทะฒะตัััะฒะฐะฝะธั ัะตะฟะปะธะบะธ ะฑะฐะทั
โ   โ   โโโ tasks/
โ   โ       โโโ main.yml
โ   โ
โ   โโโ strapi/             # ะะพะปั ะดะปั ัะฐะทะฒะตัััะฒะฐะฝะธั Strapi
โ       โโโ tasks/
โ           โโโ main.yml
โ
โโโ .env                    # ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ะฟัะพะตะบัะฐ
โโโ .gitignore
โโโ ansible.cfg             # ะะพะฝัะธะณััะฐัะธั Ansible (ะฟััะธ ะดะปั ัะพะปะตะน ะธ ะบะพะปะปะตะบัะธะน)
โโโ inventory.yml           # ะะฝะฒะตะฝัะฐัั Ansible
โโโ Makefile                # ะัััััะต ะบะพะผะฐะฝะดั ะทะฐะฟััะบะฐ
โโโ requirements.yml        # ะะตััะธะธ ะทะฐะฒะธัะธะผะพััะตะน (ansible ะผะพะดัะปะตะน)
โโโ README.md               # ะะพะบัะผะตะฝัะฐัะธั ะฟัะพะตะบัะฐ
```

---
### ๐ ะะพะผะฐะฝะดั Makefile

| ะะพะผะฐะฝะดะฐ              | ะะตะนััะฒะธะต                                                           |
|----------------------|--------------------------------------------------------------------|
| `make init`          | ะะฐะณััะถะฐะตั ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ะธะท `.env`                           |
| `make docker-install` | ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั Docker ะฝะฐ ัะตัะฒะตั                                     |
| `make docker-remove` | ะฃะดะฐะปัะตั Docker, ะตะณะพ ัะตะฟะพะทะธัะพัะธะธ, ะบะปััะธ, ะณััะฟะฟั ะธ ะดะธัะตะบัะพัะธะธ        |
| `make hw1-install`   | ะะฐะทะฒะพัะฐัะธะฒะฐะตั ะพะบััะถะตะฝะธะต HW1 (PostgreSQL + Strapi)                  |
| `make hw1-remove`    | ะะพะปะฝะพัััั ัะดะฐะปัะตั ะพะบััะถะตะฝะธะต HW1                                    |
| `make hw2-install`   | ะะฐะทะฒะพัะฐัะธะฒะฐะตั ะพะบััะถะตะฝะธะต HW2 (PostgreSQL ะบะปะฐััะตั master + replica)  |
| `make hw2-remove`    | ะะพะปะฝะพัััั ัะดะฐะปัะตั ะพะบััะถะตะฝะธะต HW2                                    |
| `make hw2-test`      | ะัะพะฒะตััะตั ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััั ัะตะฟะปะธะบะฐัะธะธ ะธ ะทะฐัะธัั ะพั ะทะฐะฟะธัะธ ะฝะฐ ัะปะตะนะฒ |
| `make hw3-install`   | ะะฐะทะฒะพัะฐัะธะฒะฐะตั ะพะบััะถะตะฝะธะต HW3 (cAdvisor + Prometheus + Grafana)      |
| `make hw3-remove`    | ะะพะปะฝะพัััั ัะดะฐะปัะตั ะพะบััะถะตะฝะธะต HW3                                    |
---

### โ ะคัะฝะบัะธะพะฝะฐะปัะฝะพััั

- ๐ณ ะฃััะฐะฝะพะฒะบะฐ ะธ ัะดะฐะปะตะฝะธะต Docker ัะตัะตะท Ansible
- ๐ ะะฐะทะฒััััะฒะฐะฝะธะต PostgreSQL master ะธ Strapi CMS (HW1)
- ๐ ะะฐะทะฒััััะฒะฐะฝะธะต ะบะปะฐััะตัะฐ PostgreSQL master + replica (HW2)
- ๐ ะัะฝะตัะตะฝะธะต ะฒัะตั ะฟะฐัะพะปะตะน ะธ ะฟะตัะตะผะตะฝะฝัั ะฒ `.env`
- ๐ฆ ะัะฟะพะปัะทะพะฒะฐะฝะธะต Docker volumes ะดะปั ัะพััะฐะฝะตะฝะธั ะดะฐะฝะฝัั Strapi
- ๐ ะะพะดะบะปััะตะฝะธะต ัะตัะฒะธัะพะฒ ัะตัะตะท ะพัะดะตะปัะฝัะต Docker-ัะตัะธ ะดะปั ะฑะตะทะพะฟะฐัะฝะพััะธ
- ๐ง ะัะพะฒะตัะบะฐ ัะตะฟะปะธะบะฐัะธะธ:
  - ะะฐะปะธัะธะต ัะฐะฑะปะธัั ะธ ะดะฐะฝะฝัั ะฝะฐ ัะตะฟะปะธะบะต
  - ะะฐัะธัะฐ ัะปะตะนะฒะฐ ะพั ะทะฐะฟะธัะธ (read-only mode)
