- name: MySQL container start
  docker_container:
    name: mysql
    image: mysql:5.7
    state: started
    restart_policy: always
    networks:
      - name: wp-network
    env:
      MYSQL_ROOT_PASSWORD: "{{ db_password }}"
      MYSQL_DATABASE: "{{ db_name }}"
      MYSQL_USER: "{{ db_user }}"
      MYSQL_PASSWORD: "{{ db_password }}"
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
    command:
      --server-id=1
      --log-bin=mysql-bin
      --binlog_do_db=mysql_db
      --relay-log=relay-log
      --gtid-mode=ON
      --enforce-gtid-consistency=TRUE
      --skip-host-cache
      --skip-name-resolve


- name: MySQL volume
  docker_volume:
    name: mysql_data
